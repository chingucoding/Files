<!--  Copyright (c) 2023 Files Community. Licensed under the MIT License. See the LICENSE.  -->
<Application
	x:Class="Files.App.App"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:primitives="http://schemas.microsoft.com/winfx/2006/xaml/presentation">

	<Application.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<XamlControlsResources xmlns="using:Microsoft.UI.Xaml.Controls" />
				<ResourceDictionary Source="/ResourceDictionaries/PathIcons.xaml" />
				<ResourceDictionary>
					<ResourceDictionary.ThemeDictionaries>
						<ResourceDictionary x:Key="Light">
							<SolidColorBrush x:Key="App.Theme.BackgroundBrush" Color="Transparent" />
							<SolidColorBrush x:Key="App.Theme.AddressBar.BackgroundBrush" Color="{StaticResource LayerOnMicaBaseAltFillColorDefault}" />
							<SolidColorBrush x:Key="App.Theme.Sidebar.BackgroundBrush" Color="{StaticResource CardBackgroundFillColorDefault}" />
							<SolidColorBrush x:Key="App.Theme.FileArea.BackgroundBrush" Color="{StaticResource CardBackgroundFillColorDefault}" />

							<SolidColorBrush x:Key="TabViewItemHeaderBackground" Color="{StaticResource SubtleFillColorTransparent}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundSelected" Color="{StaticResource LayerOnMicaBaseAltFillColorDefault}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPressed" Color="{StaticResource SubtleFillColorTertiary}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPointerOver" Color="{StaticResource SubtleFillColorSecondary}" />
						</ResourceDictionary>
						<ResourceDictionary x:Key="Dark">
							<SolidColorBrush x:Key="App.Theme.BackgroundBrush" Color="Transparent" />
							<SolidColorBrush x:Key="App.Theme.AddressBar.BackgroundBrush" Color="{StaticResource LayerOnMicaBaseAltFillColorDefault}" />
							<SolidColorBrush x:Key="App.Theme.Sidebar.BackgroundBrush" Color="#993A3A3A" />
							<SolidColorBrush x:Key="App.Theme.FileArea.BackgroundBrush" Color="#993A3A3A" />

							<SolidColorBrush x:Key="TabViewItemHeaderBackground" Color="{StaticResource SubtleFillColorTransparent}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundSelected" Color="{StaticResource LayerOnMicaBaseAltFillColorDefault}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPressed" Color="{StaticResource SubtleFillColorTertiary}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPointerOver" Color="{StaticResource SubtleFillColorSecondary}" />
						</ResourceDictionary>
						<ResourceDictionary x:Key="HighContrast">
							<SolidColorBrush x:Key="App.Theme.BackgroundBrush" Color="Transparent" />
							<SolidColorBrush x:Key="App.Theme.AddressBar.BackgroundBrush" Color="Transparent" />
							<SolidColorBrush x:Key="App.Theme.Sidebar.BackgroundBrush" Color="{StaticResource CardBackgroundFillColorDefault}" />
							<SolidColorBrush x:Key="App.Theme.FileArea.BackgroundBrush" Color="{StaticResource CardBackgroundFillColorDefault}" />

							<SolidColorBrush x:Key="TabViewItemHeaderBackground" Color="{StaticResource SystemColorWindowColor}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundSelected" Color="{StaticResource LayerFillColorDefault}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPressed" Color="{StaticResource SystemColorHighlightColor}" />
							<SolidColorBrush x:Key="TabViewItemHeaderBackgroundPointerOver" Color="{StaticResource SystemColorHighlightColor}" />
						</ResourceDictionary>
					</ResourceDictionary.ThemeDictionaries>
				</ResourceDictionary>
			</ResourceDictionary.MergedDictionaries>

			<!--  Default list view item height  -->
			<x:Double x:Key="ListItemHeight">36</x:Double>

			<!--  Default nav menu item height  -->
			<x:Double x:Key="NavigationViewItemOnLeftMinHeight">32</x:Double>

			<!--  Fix caption buttons background  -->
			<SolidColorBrush x:Key="WindowCaptionBackground" Color="Transparent" />
			<SolidColorBrush x:Key="WindowCaptionBackgroundDisabled" Color="Transparent" />

			<!--  Workaround for https://github.com/microsoft/microsoft-ui-xaml/issues/5441  -->
			<x:Double x:Key="MediaTransportControlsMinWidth">50</x:Double>

			<!--  Workaround for an issue where the shadow was showing on the tab control  -->
			<x:Double x:Key="TabViewShadowDepth">0</x:Double>

			<CornerRadius x:Key="GridViewThumbnailCornerRadius">2</CornerRadius>
			<CornerRadius x:Key="DetailsLayoutThumbnailCornerRadius">2</CornerRadius>

			<LinearGradientBrush x:Key="ControlElevationBorderBrush" MappingMode="Absolute" StartPoint="0,0" EndPoint="0,3">
				<LinearGradientBrush.RelativeTransform>
					<ScaleTransform CenterY="0.5" ScaleY="-1" />
				</LinearGradientBrush.RelativeTransform>
				<LinearGradientBrush.GradientStops>
					<GradientStop Offset="0" Color="{ThemeResource ControlStrokeColorSecondary}" />
					<GradientStop Offset="1.0" Color="{ThemeResource ControlStrokeColorDefault}" />
				</LinearGradientBrush.GradientStops>
			</LinearGradientBrush>


			<!--
				Below styles are taken from WinUI, we need to override the following three due to reference issues.
				Ideally we would have only changed the ScrollViewer style however due to StaticResource references, the framework does not pick up our style for this.
			-->
			<Style TargetType="primitives:TabViewListView">
				<Setter Property="VerticalAlignment" Value="Top" />
				<Setter Property="IsTabStop" Value="False" />
				<Setter Property="TabNavigation" Value="Once" />
				<Setter Property="IsSwipeEnabled" Value="False" />
				<Setter Property="SingleSelectionFollowsFocus" Value="False" />
				<Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
				<Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled" />
				<Setter Property="ScrollViewer.HorizontalScrollMode" Value="Enabled" />
				<Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False" />
				<Setter Property="ScrollViewer.VerticalScrollMode" Value="Disabled" />
				<Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="False" />
				<Setter Property="ScrollViewer.ZoomMode" Value="Disabled" />
				<Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False" />
				<Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="True" />
				<Setter Property="ItemContainerTransitions">
					<Setter.Value>
						<TransitionCollection>
							<AddDeleteThemeTransition />
							<ContentThemeTransition />
							<ReorderThemeTransition />
							<EntranceThemeTransition IsStaggeringEnabled="False" />
						</TransitionCollection>
					</Setter.Value>
				</Setter>
				<Setter Property="ItemsPanel">
					<Setter.Value>
						<ItemsPanelTemplate>
							<ItemsStackPanel Orientation="Horizontal" />
						</ItemsPanelTemplate>
					</Setter.Value>
				</Setter>
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="primitives:TabViewListView">
							<Border
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}"
								CornerRadius="{TemplateBinding CornerRadius}">
								<ScrollViewer
									x:Name="ScrollViewer"
									Grid.Column="1"
									AutomationProperties.AccessibilityView="Raw"
									BringIntoViewOnFocusChange="{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}"
									HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
									HorizontalScrollMode="{TemplateBinding ScrollViewer.HorizontalScrollMode}"
									IsDeferredScrollingEnabled="{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}"
									IsHorizontalRailEnabled="{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}"
									IsHorizontalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsHorizontalScrollChainingEnabled}"
									IsVerticalRailEnabled="{TemplateBinding ScrollViewer.IsVerticalRailEnabled}"
									IsVerticalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsVerticalScrollChainingEnabled}"
									Style="{StaticResource TabScrollViewerStyle}"
									TabNavigation="{TemplateBinding TabNavigation}"
									VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
									VerticalScrollMode="{TemplateBinding ScrollViewer.VerticalScrollMode}"
									ZoomMode="{TemplateBinding ScrollViewer.ZoomMode}">
									<ItemsPresenter x:Name="TabsItemsPresenter" Padding="{TemplateBinding Padding}">
										<ItemsPresenter.Header>
											<Grid Width="4">
												<Border
													x:Name="LeftBottomBorderLine"
													Width="4"
													Height="1"
													HorizontalAlignment="Left"
													VerticalAlignment="Bottom"
													Background="{ThemeResource TabViewBorderBrush}" />
											</Grid>
										</ItemsPresenter.Header>
										<ItemsPresenter.Footer>
											<Grid Width="4">
												<Border
													x:Name="RightBottomBorderLine"
													Width="4"
													Height="1"
													HorizontalAlignment="Right"
													VerticalAlignment="Bottom"
													Background="{ThemeResource TabViewBorderBrush}" />
											</Grid>
										</ItemsPresenter.Footer>
									</ItemsPresenter>
								</ScrollViewer>

								<VisualStateManager.VisualStateGroups>
									<VisualStateGroup>
										<VisualState x:Name="LeftBottomBorderLineNormal" />
										<VisualState x:Name="LeftBottomBorderLineShort">
											<VisualState.Setters>
												<Setter Target="LeftBottomBorderLine.Width" Value="2" />

											</VisualState.Setters>
										</VisualState>

									</VisualStateGroup>
									<VisualStateGroup>
										<VisualState x:Name="RightBottomBorderLineNormal" />
										<VisualState x:Name="RightBottomBorderLineShort">
											<VisualState.Setters>
												<Setter Target="RightBottomBorderLine.Width" Value="2" />

											</VisualState.Setters>
										</VisualState>

									</VisualStateGroup>
									<VisualStateGroup>
										<VisualState x:Name="NormalBottomBorderLine" />
										<VisualState x:Name="NoBottomBorderLine">
											<VisualState.Setters>
												<Setter Target="LeftBottomBorderLine.Visibility" Value="Collapsed" />
												<Setter Target="RightBottomBorderLine.Visibility" Value="Collapsed" />

											</VisualState.Setters>
										</VisualState>

									</VisualStateGroup>

								</VisualStateManager.VisualStateGroups>
							</Border>

						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>

			<Style x:Name="TabScrollViewerStyle" TargetType="ScrollViewer">
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="ScrollViewer">
							<Border
								x:Name="Root"
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}">
								<Grid>

									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto" MinWidth="2" />
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>
									<Border
										x:Name="LeftBottomBorderLine"
										Height="1"
										VerticalAlignment="Bottom"
										Background="{ThemeResource TabViewBorderBrush}" />
									<!--  Below is the only modification compared to the WinUI 3 styles  -->
									<Border
										x:Name="MiddleBottomBorderLine"
										Grid.Column="1"
										Height="1"
										VerticalAlignment="Bottom"
										Background="Transparent" />
									<Border
										x:Name="RightBottomBorderLine"
										Grid.Column="2"
										Height="1"
										VerticalAlignment="Bottom"
										Background="{ThemeResource TabViewBorderBrush}" />
									<Border
										x:Name="ScrollDecreaseButtonContainer"
										Padding="{ThemeResource TabViewItemLeftScrollButtonContainerPadding}"
										VerticalAlignment="Bottom"
										Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}">
										<RepeatButton
											x:Name="ScrollDecreaseButton"
											AutomationProperties.AccessibilityView="Raw"
											Delay="50"
											HighContrastAdjustment="None"
											Interval="100"
											IsTabStop="False"
											Style="{StaticResource TabViewScrollButtonStyle}">
											<FontIcon
												FontFamily="{ThemeResource SymbolThemeFontFamily}"
												FontSize="{ThemeResource TabViewItemScrollButonFontSize}"
												Glyph="&#xEDD9;"
												MirroredWhenRightToLeft="True" />
										</RepeatButton>
									</Border>
									<ScrollContentPresenter
										x:Name="ScrollContentPresenter"
										Grid.Column="1"
										Padding="1,0,0,0"
										TabFocusNavigation="Once" />
									<Border
										x:Name="ScrollIncreaseButtonContainer"
										Grid.Column="2"
										Padding="{ThemeResource TabViewItemRightScrollButtonContainerPadding}"
										VerticalAlignment="Bottom"
										Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}">
										<RepeatButton
											x:Name="ScrollIncreaseButton"
											AutomationProperties.AccessibilityView="Raw"
											Delay="50"
											HighContrastAdjustment="None"
											Interval="100"
											IsTabStop="False"
											Style="{StaticResource TabViewScrollButtonStyle}">
											<FontIcon
												FontFamily="{ThemeResource SymbolThemeFontFamily}"
												FontSize="{ThemeResource TabViewItemScrollButonFontSize}"
												Glyph="&#xEDDA;"
												MirroredWhenRightToLeft="True" />
										</RepeatButton>
									</Border>

								</Grid>

								<VisualStateManager.VisualStateGroups>
									<VisualStateGroup>
										<VisualState x:Name="NormalBottomBorderLine" />
										<VisualState x:Name="NoBottomBorderLine">
											<VisualState.Setters>
												<Setter Target="LeftBottomBorderLine.Visibility" Value="Collapsed" />
												<Setter Target="MiddleBottomBorderLine.Visibility" Value="Collapsed" />
												<Setter Target="RightBottomBorderLine.Visibility" Value="Collapsed" />

											</VisualState.Setters>
										</VisualState>

									</VisualStateGroup>

								</VisualStateManager.VisualStateGroups>
							</Border>

						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>

			<Style x:Name="TabViewScrollButtonStyle" TargetType="RepeatButton">
				<Setter Property="Background" Value="{ThemeResource TabViewScrollButtonBackground}" />
				<Setter Property="Foreground" Value="{ThemeResource TabViewScrollButtonForeground}" />
				<Setter Property="CornerRadius" Value="{ThemeResource ControlCornerRadius}" />
				<Setter Property="FontSize" Value="{ThemeResource TabViewItemScrollButonFontSize}" />
				<Setter Property="FontFamily" Value="{ThemeResource SymbolThemeFontFamily}" />
				<Setter Property="Width" Value="{ThemeResource TabViewItemScrollButtonWidth}" />
				<Setter Property="Height" Value="{ThemeResource TabViewItemScrollButtonHeight}" />
				<Setter Property="FontFamily" Value="{ThemeResource SymbolThemeFontFamily}" />
				<Setter Property="BorderThickness" Value="{ThemeResource TabViewButtonBorderThickness}" />
				<Setter Property="BorderBrush" Value="{ThemeResource TabViewScrollButtonBorderBrush}" />
				<Setter Property="FocusVisualMargin" Value="-3" />
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="RepeatButton">
							<ContentPresenter
								x:Name="ContentPresenter"
								HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
								VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
								AutomationProperties.AccessibilityView="Raw"
								Background="{TemplateBinding Background}"
								BackgroundSizing="{TemplateBinding BackgroundSizing}"
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}"
								Content="{TemplateBinding Content}"
								ContentTemplate="{TemplateBinding ContentTemplate}"
								ContentTransitions="{TemplateBinding ContentTransitions}"
								CornerRadius="{TemplateBinding CornerRadius}"
								FontFamily="{TemplateBinding FontFamily}"
								FontSize="{TemplateBinding FontSize}"
								FontWeight="{TemplateBinding FontWeight}">
								<VisualStateManager.VisualStateGroups>
									<VisualStateGroup x:Name="CommonStates">
										<VisualState x:Name="Normal" />

										<VisualState x:Name="PointerOver">

											<Storyboard>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBackgroundPointerOver}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonForegroundPointerOver}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBorderBrushPointerOver}" />
												</ObjectAnimationUsingKeyFrames>
											</Storyboard>
										</VisualState>

										<VisualState x:Name="Pressed">

											<Storyboard>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBackgroundPressed}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonForegroundPressed}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBorderBrushPressed}" />
												</ObjectAnimationUsingKeyFrames>
											</Storyboard>
										</VisualState>

										<VisualState x:Name="Disabled">

											<Storyboard>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBackgroundDisabled}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonForegroundDisabled}" />
												</ObjectAnimationUsingKeyFrames>
												<ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
													<DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource TabViewScrollButtonBorderBrushDisabled}" />
												</ObjectAnimationUsingKeyFrames>
											</Storyboard>
										</VisualState>

									</VisualStateGroup>

								</VisualStateManager.VisualStateGroups>
							</ContentPresenter>

						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Style>
		</ResourceDictionary>
	</Application.Resources>
</Application>
